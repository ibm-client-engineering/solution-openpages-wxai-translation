"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8201],{898:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var a=n(5893),s=n(1151);const i={title:"Custom Translation Service",sidebar_position:1,description:"Considerations for creating a custom translation service for OpenPages",custom_edit_url:null},o=void 0,r={id:"Create/Translate User Fields/Custom API Endpoint",title:"Custom Translation Service",description:"Considerations for creating a custom translation service for OpenPages",source:"@site/docs/04-Create/01-Translate User Fields/02-Custom API Endpoint.mdx",sourceDirName:"04-Create/01-Translate User Fields",slug:"/Create/Translate User Fields/Custom API Endpoint",permalink:"/solution-openpages-wxai-translation/Create/Translate User Fields/Custom API Endpoint",draft:!1,unlisted:!1,editUrl:null,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Custom Translation Service",sidebar_position:1,description:"Considerations for creating a custom translation service for OpenPages",custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"watsonx.ai Translation Service",permalink:"/solution-openpages-wxai-translation/Create/Translate User Fields/watsonxai  Translation Service"},next:{title:"Translate Headers and Labels",permalink:"/solution-openpages-wxai-translation/Create/Translate Headers and Labels"}},l={},c=[{value:"Translating with NeuralSeek from an OpenPages perspective",id:"translating-with-neuralseek-from-an-openpages-perspective",level:3},{value:"Translating with OpenPages from a NeuralSeek mimic perspective",id:"translating-with-openpages-from-a-neuralseek-mimic-perspective",level:3},{value:"Technical details",id:"technical-details",level:3},{value:"Outcome",id:"outcome",level:3}];function d(e){const t={code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{borderBottom:"1px solid #000",marginTop:"20px",marginBottom:"20px"}}),"\n",(0,a.jsx)(t.h3,{id:"translating-with-neuralseek-from-an-openpages-perspective",children:"Translating with NeuralSeek from an OpenPages perspective"}),"\n",(0,a.jsxs)(t.p,{children:["To initially validate a NeuralSeek endpoint for translation, OpenPages will send a POST request to ",(0,a.jsx)(t.code,{children:"<endpoint>/translate/"})," with the body ",(0,a.jsx)(t.code,{children:'{text: ["test connection"], "target": "en"}'})," (be aware that it will use a trailing slash, which may cause issues for some backend frameworks). This is also the same format that OpenPages will use for all translation requests, always with a single string in the target field's array and with no indication of source language."]}),"\n",(0,a.jsx)(t.p,{children:"The output that OpenPages expects is:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n    "character_count": <int>, \n    "detected_language": <string>, \n    "detected_language_confidence": <float>, \n    "translations": [<string>],\n    "word_count": <int>\n}\n'})}),"\n",(0,a.jsx)(t.p,{children:"OpenPages will also send the API key that you provide as basic authorization. For the purposes of our POC we ignored it."}),"\n",(0,a.jsx)(t.h3,{id:"translating-with-openpages-from-a-neuralseek-mimic-perspective",children:"Translating with OpenPages from a NeuralSeek mimic perspective"}),"\n",(0,a.jsxs)(t.p,{children:["The main step you need to complete before running the application is to create a ",(0,a.jsx)(t.code,{children:".env"})," file with the requisite credentials:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"WX_PROJECT_ID=<watsonx Project ID>\nWX_API_KEY=<watsonx API Key>\nWX_API_URL=<watsonx API url>\n"})}),"\n",(0,a.jsx)(t.h3,{id:"technical-details",children:"Technical details"}),"\n",(0,a.jsxs)(t.p,{children:["When creating the ",(0,a.jsx)(t.code,{children:"/translate"})," endpoint there are two steps to completing the translation using an LLM. The first step is to identify the source language, which we did by using a prompt that gave a the LLM only two options. This probably improved the accuracy of the source language detection but its proficiency in dinstinguishing a wider variety of lanugages is unknown."]}),"\n",(0,a.jsx)(t.p,{children:'The second step is to do the translation, using the source language information determined in the first step. We wanted the prompt to be modular enough so that we could use it for any combination of source and target language, although in our case we are only using it for English -> Japanese. To that end, we kept a dictionary of examples for the same phrase in every language we wanted to support for this translation, so that we could easily access the translation examples for the LLM to use. We also directed the LLM to output the translation within a JSON object, which allows us to use the closed curly bracket "}" as a stop sequence.'}),"\n",(0,a.jsxs)(t.p,{children:["To host this endpoint, we utilized IBM Code Engine, which can run containers in a fairly straightforward way. Code Engine uses an x86 architecture, so when you build the container image for the translation endpoint specify at least the ",(0,a.jsx)(t.code,{children:"linux/amd64"})," platform. We built the image using podman buildx and hosted it on dockerhub. From there, you can create a new application on Code Engine and specify the Image reference as the image you pushed to dockerhub. As long as the image repo you pushed it to is public, you shouldn't need a registry secret. In addition, this application doesn't need a lot of power to run, so you can be conservative with the allocation of compute resources. You also will not need more than one instance of the container."]}),"\n",(0,a.jsxs)(t.p,{children:["There's also a ",(0,a.jsx)(t.code,{children:"/history"})," endpoint for debugging, as we do not recommend trying to use Code Engine's lackluster logging."]}),"\n",(0,a.jsx)(t.h3,{id:"outcome",children:"Outcome"}),"\n",(0,a.jsx)(t.p,{children:"Once the container has been set up and the integration saved in the OpenPages application, the translation feature will be enabled. There are two primary avenues for using this feature, translating object pages and auto-translating configuration text."}),"\n",(0,a.jsx)(t.p,{children:"On any object page, there is a translation icon near the top right of the main tile. Clicking it will send a series of requests to the endpoint that we set up, and after the translations have completed the page will update to show the translated text. The text is translated from whatever language it is in originally into the language specified by the user's locale. Each translated field will also have a button to show the original, untranslated text."}),"\n",(0,a.jsx)("figure",{children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.img,{alt:"Before",src:n(2933).Z+"",width:"3208",height:"1840"}),"\n",(0,a.jsx)("figcaption",{children:" Before "})]})}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)("figure",{children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.img,{alt:"After",src:n(1741).Z+"",width:"3200",height:"1830"}),"\n",(0,a.jsx)("figcaption",{children:" After "})]})}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)("br",{}),"\n",(0,a.jsx)(t.p,{children:'To use the auto translate feature for configuration text, navigate to the right side bar under the settings icon (gear), and expand the "System Configuration" list.'}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Navigate to headers",src:n(9615).Z+"",width:"3206",height:"1838"})}),"\n",(0,a.jsx)(t.p,{children:"Select the category of configuration text you would like to translate. You will find a list of fields that OpenPages stores as part of its configuration, along with associated translations. There is a button on the top to automatically translate the text fields for each locale using the translation service we set up. In our case, it fails for every language except English and Japanese due to a lack of support."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Translate_headers",src:n(99).Z+"",width:"3204",height:"1836"})})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1741:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/after_translate-3a1c10013efbb77243473d4c2d465496.png"},2933:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/before_translate-abf230b91f51f0a0d2225cb1baf1d716.png"},9615:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nav_headers-25037db50abef0bad69ff2b7f9149c85.png"},99:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/translate_headers-7802e860d7c471769373488987b75dbe.png"},1151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>o});var a=n(7294);const s={},i=a.createContext(s);function o(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);